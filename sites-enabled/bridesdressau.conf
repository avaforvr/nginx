server {
    listen       80;
    listen       443 ssl;
    server_name  dev.bridesdressau.com *.bridesdressau.com;
    set $v5path D:/zwnmp/web/jjshouse/v5/;

    #ssl on;
    #ssl_certificate ssl/jjshouse.com.crt;
    #ssl_certificate_key ssl/jjshouse.com.key;

    access_log  logs/bridesdressau.access.log  main;

    root   D:/zwnmp/web/bridesdressau;
    index  index.html index.htm index.php;

    if (!-e $request_filename) {
            #rewrite ^/(.*) /index.php last;
            #rewrite ^/(.*) http://5orz.com/ last;
    }

	rewrite /xhprof_html/index.php /v5/vendor/facebook/xhprof/xhprof_html/index.php last;
    rewrite /qa\/[^\/]+-cid([0-9]+)-q([0-9]+)\/?$ /goods_question.php?cat_id=$1&goods_id=$2 last;
    rewrite /reviews\/?$ /reviews.php last;
    rewrite /reviews\/[^\/]+-c([0-9]+)\/?$ /reviews.php?cat_id=$1 last;
    #rewrite /reviews\/[^\/]+-cid([0-9]+)-p([0-9]+)\/?$ /reviews.php?cat_id=$1&comment_id=$2 last;
    rewrite /new\-products\/(\d+\-\d+\-\d+)?\/?$ /new_products.php?date=$1 last;
    rewrite /new\-products\/(\d+\-\d+\-\d+)?\/p(\d*)\/?$ /new_products.php?date=$1&page=$2 last;
	rewrite /qa\/?$ /goods_question.php last;
	rewrite /qa\/[^\/]+-cid([0-9]+)-q([0-9]+)\/?$ /goods_question.php?cat_id=$1&goods_id=$2 last;
    rewrite (?i)/(Cheap-[^\/]+\.html)(.*)$ /filter.php?route=$1 last;
    rewrite /[^\/]+-x([0-9]+)(.*)$ /ccc.php?cat_id=$1&filter=$2 last;
    rewrite /[^\/]*-c([0-9]+)(.*)$ /filter.php?cat_id=$1&filter=$2 last;
    rewrite /[^\/]*-f([0-9]+)(.*)$ /filter.php?cat_id=$1&filter=$2 last;
    rewrite /[^\/]*-g([0-9]+)\/?$ /goods.php?goods_id=$1 last;
    rewrite /[^\/]+-a([0-9]+)\/?$ /category.php?attr_id=$1 last;

	rewrite ^/search/([^\/]+)\/?$  /search.php?q=$1 last;
    rewrite /tag/([^\/]+)\/?$  /tag/index.php?q=$1 last;
    rewrite /tag/([^\/]+)/([^\/]+)\/?$  /search.php?q=$2 last;
    rewrite /promotion/([^\/]+)\/?$  /promotion/index.php?code=$1 last;
    rewrite /(weekly-deals)\/?$  /promotion/index.php?code=$1 last;
    rewrite /return\/?$ /about/help.php?page_id=84 last;
    rewrite /region\/?$ /region_seo.php last;
    rewrite /region/(\w+)-region\/?$ /region_seo.php?region_code=$1 last;
    rewrite /region\/[^\/]+-state-code-(\w+)-(\w+)\/?$ /region_seo.php?region_code=$1&state_code=$2 last;
    rewrite /region\/[^\/]+-r([0-9]+)\/?$ /region_seo.php?region_id=$1 last;
    rewrite /region\/[^\/]+-r([0-9]+)c([0-9]+)\/?$ /region_seo.php?region_id=$1&cat_id=$2 last;

    #category
	#rewrite ^/wedding-dresses\/?(.*)$  /filter.php?cat_id=2&filter=$1 last;
    #rewrite ^/bridesmaid-dresses\/?(.*)$  /filter.php?cat_id=7&filter=$1 last;
    rewrite ^/([a-z\-]*-?wedding-dresses)\/?(.*)$ /filter.php?route=$1&filter=$2 last;
    rewrite ^/([a-z\-]*-?bridesmaid-dresses)\/?(.*)$ /filter.php?route=$1&filter=$2 last;
    rewrite ^/(wedding-dresses-(2014|with\-straps|melbourne|sydney|brisbane|perth|adelaide))\/?(.*)$ /filter.php?route=$1&filter=$3 last;
    rewrite ^/(bridesmaid-dresses-(melbourne|sydney|brisbane|perth))\/?(.*)$ /filter.php?route=$1&filter=$2 last;

    #help
    rewrite /about-us\/?$ /about/help.php?page_id=2 last;
    rewrite /contact-us\/?$ /about/help.php?page_id=30 last;
    rewrite /security-privacy\/?$ /about/help.php?page_id=86 last;
    rewrite /terms-conditions\/?$ /about/help.php?page_id=85 last;
    rewrite /delivery\/?$ /about/help.php?page_id=11 last;
    rewrite /payment\/?$ /about/help.php?page_id=107 last;
    rewrite /return-cancellation\/?$ /about/help.php?page_id=84 last;
    rewrite /faq\/?$ /about/help.php?page_id=8 last;

    #error_page  404              /404.html;

    # redirect server error pages to the static page /50x.html
    #
    error_page   500 502 503 504  /50x.html;
    location = /50x.html {
    root   html;
    }

    # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000
    #
    location ~ \.php$ {
        #root           html;
        fastcgi_pass   127.0.0.1:9000;
        fastcgi_index  index.php;

        fastcgi_param  APP_FS_ROOT D:/zwnmp/web/bridesdressau/;
        fastcgi_param  V5_PATH $v5path;
        fastcgi_param  SCRIPT_FILENAME  D:/zwnmp/web/bridesdressau$fastcgi_script_name;

        include        fastcgi_params;
    }
}